<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
<title>Sforzu ¬∑ CPET & Watt test</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
<meta name="theme-color" content="#0a84ff">
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header><h1>Sforzu</h1></header>
<div class="container">

  <!-- STEP 0 -->
  <div class="card" id="step-0">
    <div class="stepper"><span class="active"></span><span></span><span></span><span></span><span></span><span></span></div>
    <h2>Seleziona l'esame</h2>
    <div class="row">
      <div class="col">
        <label>Esame</label>
        <select id="examType">
          <option value="watt">Watt test</option>
          <option value="cpet">CPET</option>
        </select>
      </div>
      <div class="col">
        <label>Ergometro</label>
        <select id="ergometer">
          <option value="cycle">Cicloergometro</option>
          <option value="treadmill">Treadmill</option>
        </select>
      </div>
      <div class="col">
        <label>Profilo</label>
        <select id="profile">
          <option value="standard">Standard</option>
          <option value="athlete">Atleta</option>
          <option value="ihd">Cardiopatia ischemica</option>
          <option value="betablocker">Terapia Œ≤-bloccante</option>
          <option value="copd">Broncopneumopatia</option>
        </select>
        <small class="helper">Suggeriremo rampa/start/durata.</small>
      </div>
    </div>
    <div class="row">
      <div class="col"><label>Et√†</label><input id="age" type="number" min="10" max="100"></div>
      <div class="col"><label>Sesso</label><select id="sex"><option value="M">Maschio</option><option value="F">Femmina</option></select></div>
      <div class="col"><label>Peso (kg)</label><input id="weight" type="number" step="0.1"></div>
      <div class="col"><label>Altezza (cm)</label><input id="height" type="number" step="0.5"></div>
    </div>
    <div class="btnbar"><button id="toStep1">Avanti</button></div>
  </div>

  <!-- STEP 1: Protocollo suggerito -->
  <div class="card hidden" id="step-1">
    <div class="stepper"><span></span><span class="active"></span><span></span><span></span><span></span><span></span></div>
    <h2>Protocollo suggerito</h2>
    <div class="row">
      <div class="col"><label>Start</label><input id="protoStart" type="number"></div>
      <div class="col"><label>Rampa</label><input id="protoRamp" type="number"></div>
      <div class="col"><label>Durata target (min)</label><input id="protoDur" type="number"></div>
    </div>
    <div id="protoNote" class="footer-note"></div>
    <div class="btnbar"><button class="ghost" id="back0">Indietro</button><button id="toStep2">Avanti</button></div>
  </div>

  <!-- STEP 2: Emodinamica / performance -->
  <div class="card hidden" id="step-2">
    <div class="stepper"><span></span><span></span><span class="active"></span><span></span><span></span><span></span></div>
    <h2>Dati emodinamici & performance</h2>
    <div class="row">
      <div class="col"><label>Watt picco (W)</label><input id="wPeak" type="number"></div>
      <div class="col"><label>FC riposo</label><input id="hrRest" type="number"></div>
      <div class="col"><label>FC picco</label><input id="hrPeak" type="number"></div>
      <div class="col"><label>FC 1‚Ä≤</label><input id="hr1" type="number"></div>
      <div class="col"><label>FC 3‚Ä≤</label><input id="hr3" type="number"></div>
    </div>
    <div class="row">
      <div class="col"><label>PAS riposo</label><input id="sbpRest" type="number"></div>
      <div class="col"><label>PAS picco</label><input id="sbpPeak" type="number"></div>
      <div class="col"><label>PAS 3‚Ä≤</label><input id="sbpRec" type="number"></div>
      <div class="col"><label>PAD riposo</label><input id="dbpRest" type="number"></div>
    </div>
    <div class="row">
      <div class="col"><label>Durata effettiva (min)</label><input id="dur" type="number" step="0.1"></div>
      <div class="col"><label>Borg dispnea (0‚Äì10)</label><input id="borg" type="number" step="0.5"></div>
    </div>
    <div class="btnbar"><button class="ghost" id="back1">Indietro</button><button id="toStep3">Avanti</button></div>
  </div>

  <!-- STEP 3: Ventilatorio (solo CPET) + Spirometria opzionale -->
  <div class="card hidden" id="step-3">
    <div class="stepper"><span></span><span></span><span></span><span class="active"></span><span></span><span></span></div>
    <h2>Modulo ventilatorio (solo CPET)</h2>
    <div id="ventBlock">
      <div class="row">
        <div class="col"><label>VO‚ÇÇ peak (ml/kg/min)</label><input id="vo2" type="number" step="0.1"></div>
        <div class="col"><label>AT (ml/kg/min)</label><input id="at" type="number" step="0.1"></div>
        <div class="col"><label>RER picco</label><input id="rer" type="number" step="0.01"></div>
        <div class="col"><label>SpO‚ÇÇ min (%)</label><input id="spo2" type="number"></div>
      </div>
      <div class="row">
        <div class="col"><label>VE/VCO‚ÇÇ slope</label><input id="slope" type="number" step="0.1"></div>
        <div class="col"><label>ŒîVO‚ÇÇ/ŒîW</label><input id="dvo2dw" type="number" step="0.1"></div>
        <div class="col"><label>OUES</label><input id="oues" type="number" step="0.1"></div>
        <div class="col"><label>BR% (VE/MVV√ó100)</label><input id="br" type="number" step="0.1"></div>
      </div>
      <details class="card" style="padding:10px;margin:10px 0;">
        <summary>Opzionali (PetCO‚ÇÇ, VD/VT, EQ)</summary>
        <div class="row">
          <div class="col"><label>PetCO‚ÇÇ riposo</label><input id="petco2r" type="number"></div>
          <div class="col"><label>PetCO‚ÇÇ AT</label><input id="petco2at" type="number"></div>
          <div class="col"><label>PetCO‚ÇÇ picco</label><input id="petco2p" type="number"></div>
          <div class="col"><label>VD/VT</label><input id="vdvt" type="number" step="0.01"></div>
        </div>
      </details>
      <details class="card" style="padding:10px;margin:10px 0;">
        <summary>Spirometria (opzionale)</summary>
        <div class="row">
          <div class="col"><label>FEV‚ÇÅ (L)</label><input id="fev1" type="number" step="0.01"></div>
          <div class="col"><label>FVC (L)</label><input id="fvc" type="number" step="0.01"></div>
          <div class="col"><label>FEV‚ÇÅ/FVC (%)</label><input id="ratio" type="number" step="0.1" placeholder="auto"></div>
        </div>
        <div class="row">
          <div class="col">
            <label>Predetti</label>
            <select id="spiroModel">
              <option value="rapid">Rapido</option>
              <option value="ane2023">GLI/ANE 2023 (beta)</option>
            </select>
          </div>
        </div>
        <div id="spiroOut" class="footer-note"></div>
      </details>
    </div>
    <div class="notice" id="ventNote">Per il Watt test, salta questo step.</div>
    <div class="btnbar"><button class="ghost" id="back2">Indietro</button><button id="toStep4">Avanti</button></div>
  </div>

  <!-- STEP 4: Adeguatezza -->
  <div class="card hidden" id="step-4">
    <div class="stepper"><span></span><span></span><span></span><span></span><span class="active"></span><span></span></div>
    <h2>Adeguatezza del test</h2>
    <div id="adequacy" class="footer-note">Compila i dati e premi ‚ÄúCalcola risultati‚Äù.</div>
    <div class="btnbar"><button class="ghost" id="back3">Indietro</button><button id="toStep5">Calcola risultati</button></div>
  </div>

  <!-- STEP 5: Risultati -->
  <div class="card hidden" id="step-5">
    <div class="stepper"><span></span><span></span><span></span><span></span><span></span><span class="active"></span></div>
    <h2>Risultati & interpretazione</h2>
    <div id="results"></div>
    <div class="btnbar"><button class="copy" id="copyBtn">üìã Copia referto sintetico</button><button class="ghost" id="restart">Nuovo esame</button></div>
  </div>

</div>
<script src="app.js"></script>
</body>
</html>
